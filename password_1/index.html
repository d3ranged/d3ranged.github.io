<!DOCTYPE html> <html lang="en-US"> <head prefix="og: http://ogp.me/ns#"> <meta charset="UTF-8" /> <meta http-equiv="X-UA-Compatible" content="ie=edge" /> <meta name="viewport" content="width=device-width, initial-scale=1.0" /> <meta name="mobile-web-app-capable" content="yes" /> <meta name="apple-mobile-web-app-capable" content="yes" /> <meta name="application-name" content="d3ranged blog" /> <meta name="apple-mobile-web-app-status-bar-style" content="#fff" /> <meta name="apple-mobile-web-app-title" content="d3ranged blog" /> <title> 128 бит и больше - d3ranged blog </title> <link rel="alternate" href="http://localhost:4000/password_1/" hreflang="en-US" /> <link rel="canonical" href="http://localhost:4000/password_1/" /> <meta name="description" content="site description" /> <meta name="referrer" content="no-referrer-when-downgrade" /> <meta property="fb:app_id" content="" /> <meta property="og:site_name" content="128 бит и больше | " /> <meta property="og:title" content="128 бит и больше | " /> <meta property="og:type" content="website" /> <meta property="og:url" content="http://localhost:4000/password_1/" /> <meta property="og:description" content="site description" /> <meta property="og:image" content="" /> <meta property="og:image:width" content="640" /> <meta property="og:image:height" content="640" /> <meta name="twitter:card" content="summary" /> <meta name="twitter:title" content="128 бит и больше | " /> <meta name="twitter:url" content="http://localhost:4000/password_1/" /> <meta name="twitter:site" content="@" /> <meta name="twitter:creator" content="@" /> <meta name="twitter:description" content="" /> <meta name="twitter:image" content="" /> <link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="d3ranged blog" /> <link rel="apple-touch-icon" sizes="180x180" href="/assets/favicons/apple-touch-icon.png"> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicons/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicons/favicon-16x16.png"> <link rel="manifest" href="/assets/favicons/site.webmanifest"> <meta name="apple-mobile-web-app-title" content="d3ranged blog" /> <meta name="application-name" content="d3ranged blog" /> <meta name="msapplication-TileColor" content="#da532c" /> <meta name="theme-color" content="#2c2c2c" /> <link rel="stylesheet" href="/assets/css/style.css" /> <link rel="stylesheet" href="/assets/css/fontello.css" /> </head> <body data-theme="dark"> <div class="navbar" role="navigation"> <nav class="menu"> <input type="checkbox" id="menu-trigger" class="menu-trigger" /> <label for="menu-trigger"> <span class="menu-icon"> <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <path d="M64,384H448V341.33H64Zm0-106.67H448V234.67H64ZM64,128v42.67H448V128Z" /> </svg> </span> </label> <a id="mode"> <svg class="mode-sunny" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>LIGHT</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> <svg class="mode-moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 512 512" > <title>DARK</title> <line x1="256" y1="48" x2="256" y2="96" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="256" y1="416" x2="256" y2="464" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="108.92" x2="369.14" y2="142.86" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="369.14" x2="108.92" y2="403.08" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="464" y1="256" x2="416" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="96" y1="256" x2="48" y2="256" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="403.08" y1="403.08" x2="369.14" y2="369.14" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <line x1="142.86" y1="142.86" x2="108.92" y2="108.92" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> <circle cx="256" cy="256" r="80" style="stroke-linecap:round;stroke-miterlimit:10;stroke-width:32px" /> </svg> </a> <div class="trigger"> <div class="trigger-container"><a class="menu-link" href="/"><i class="icon-home"></i>home</a><a class="menu-link" href="/archive/"><i class="icon-folder-open"></i>archive</a><a class="menu-link" href="/about/"><i class="icon-star"></i>about</a><a class="menu-link" href="/donate/"><i class="icon-dollar"></i></a></div> </div> </nav> </div> <div class="wrapper post"> <main class="page-content" aria-label="Content"> <article itemscope itemtype="https://schema.org/BlogPosting"> <header class="header"> <div class="tags"> <span itemprop="keywords"> <a class="tag" href="/tags/#manual">MANUAL</a> </span> </div> <h1 class="header-title" itemprop="headline">128 бит и больше</h1> <div class="post-meta"> <span class="post-meta-item"> <!--<i class="icon-lock-open-alt"></i>--> <time datetime="2021-05-21T00:00:00+03:00" itemprop="datePublished"> May 21, 2021 </time> </span> <span class="post-meta-item" itemprop="author" itemscope itemtype="https://schema.org/Person"> <i class="icon-user-o"></i> <span itemprop="name">d3ranged</span> </span> <time hidden datetime="" itemprop="dateModified"> May 21, 2021 </time> <span hidden itemprop="publisher" itemtype="Person">d3ranged</span> <span hidden itemprop="image"></span> <span hidden itemprop="mainEntityOfPage"><p>Стойкость пароля зависит от алгоритма, который его использует. Оценить скорость перебора на GPU можно по <a href="https://github.com/vay3t/hashcatbenchmark">hashcat benchmark</a>. Отличие скорости работы слабых алгоритмов от сильных в пределах 10^6. Это большая цифра, но только для плохих паролей!</p> </span> </div> </header> <div class="page-content" itemprop="articleBody"> <p>Стойкость пароля зависит от алгоритма, который его использует. Оценить скорость перебора на GPU можно по <a href="https://github.com/vay3t/hashcatbenchmark">hashcat benchmark</a>. Отличие скорости работы слабых алгоритмов от сильных в пределах 10^6. Это большая цифра, но только для плохих паролей!</p> <p>Количество возможных паролей удваивается с увеличением длины на 1 бит: старое число паролей с единицей, плюс оно же с нулём. Для сохранения той же скорости взлома, потребуется купить второй GPU. Даже если собрать ферму из 100 граф-карт, это даст всего лишь стократный прирост скорости. Увеличение же длины пароля на байт, умножит число вариантов на 256. После определенного числа бит полный перебор лишается экономического смысла. На сегодня таким значением считается 128 бит.</p> <p>Как узнать число вариантов? Обычная комбинаторика. Число возможных элементов в степени длины пароля. В нашем случае речь идет о битах, что даёт 2 возможных значения: 0 и 1. И таких 128 штук, значит 2 ^ 128. Это примерно 10^38. Взлом абсолютно нерентабелен!</p> <blockquote> <p>В рамках статьи, под стойкостью понимается количество попыток при полном переборе. Для удобства она записывается как число бит, хотя это лишь другая форма записи количества вариантов.</p> </blockquote> <p>Но как узнать число бит, зная только число вариантов? Если пароль собран из 15 цифр, вариантов 10^15. Для перевода бит в варианты, мы возводили два в степень. Что бы узнать в какое число бит влезет число всех вариантов, нужно провести обратную процедуру! Логарифмирование по основанию два:</p> <blockquote> <p>10^15 = 2^X<br /> X = log2(10^15) = 49.8</p> </blockquote> <p>Округлив, получаем что стойкость такого пароля - 50 бит. Цифровой пароль оказался довольно слабым.</p> <h2 id="как-же-выбрать-пароль"> <a href="#как-же-выбрать-пароль" class="anchor-head"></a> Как же выбрать пароль? </h2> <p>Сгенерировать 128 случайных бит, т.е. ровно 16 байт. Большинство систем требуют пароль в ASCII, поэтому нам потребуется его перекодировать. Для отправки бинарных файлов по текстовым протоколам используют кодировку base_64. Мы можем выбрать любую или даже придумать свою. Стойкость пароля это не уменьшит.</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1"># здесь и далее весь код будет на Python3
</span><span class="kn">import</span> <span class="n">secrets</span>
<span class="n">key_int</span> <span class="o">=</span> <span class="n">secrets</span><span class="p">.</span><span class="nf">randbits</span><span class="p">(</span><span class="mi">128</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">key_int</span><span class="p">))</span>
<span class="c1"># 0x2af0f3958e106d1621658dbd7bd7653b
</span></code></pre></div></div> <h2 id="как-это-запомнить"> <a href="#как-это-запомнить" class="anchor-head"></a> Как это запомнить? </h2> <p>Многократное повторение? Есть метод проще. До этого момента мы кодировали base_256 (т.е. обычный байт) в base_16. Но что, если мы кодируем пароль в base_2048? Только вместо привычных чисел возьмём слова. Этот метод называется <a href="https://en.bitcoin.it/wiki/BIP_0039">BIP_0039</a> и активно применяется для бэкапа крипто-кошельков.</p> <p>Его предшественник <a href="https://theworld.com/~reinhold/diceware.html">Diceware</a> использовал словарь на <a href="https://theworld.com/%7Ereinhold/dicewarewordlist.pdf">7776 слов</a> и был полностью аналоговым.</p> <p>В чем их отличие? BIP_0039 использует меньший словарь и имеет проверку целостности. Словарь - ключевой элемент системы. Если слова трудно запомнить или легко спутать друг с другом, то пароль бесполезен.</p> <h2 id="как-работает-bip_0039"> <a href="#как-работает-bip_0039" class="anchor-head"></a> Как работает BIP_0039? </h2> <ul> <li>128-битный секрет хешируется sha256</li> <li>первые 4 бита хеша добавляют к 128-битам секрета</li> <li>полученную 132 битную строку делят на 12 частей по 11 бит</li> <li>число в 11-бит дает диапазон от 0 до 2047</li> <li>берут специальный словарь на <a href="https://raw.githubusercontent.com/bitcoinjs/bip39/master/src/wordlists/english.json">2048 слов</a></li> <li>заменяют каждое число на соответствующее ему слово</li> <li>получают 12 слов, содержащих секрет и хеш</li> </ul> <p>Такой пароль легко запомнить и, главное, сделать его копию, скажем в рамках не вызывающего подозрения рукописного словаря.</p> <h2 id="практика"> <a href="#практика" class="anchor-head"></a> Практика! </h2> <p>Установим библиотеку <a href="https://github.com/trezor/python-mnemonic">mnemonic</a>d</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kn">from</span> <span class="n">mnemonic</span> <span class="kn">import</span> <span class="n">Mnemonic</span>

<span class="n">mnemo</span> <span class="o">=</span> <span class="nc">Mnemonic</span><span class="p">(</span><span class="s">'english'</span><span class="p">)</span>
<span class="n">key_int</span> <span class="o">=</span> <span class="mh">0x2af0f3958e106d1621658dbd7bd7653b</span>
<span class="n">key_byte</span> <span class="o">=</span> <span class="n">key_int</span><span class="p">.</span><span class="nf">to_bytes</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="s">'little'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="n">mnemo</span><span class="p">.</span><span class="nf">to_mnemonic</span><span class="p">(</span><span class="n">key_byte</span><span class="p">))</span>

<span class="c1"># derive concert ten kitchen stone mountain fluid pear model question winter feel
</span></code></pre></div></div> <p>Теперь получим из слов байты:</p> <div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">words</span> <span class="o">=</span> <span class="s">'derive concert ten kitchen stone mountain fluid pear model question winter feel'</span>
<span class="n">out_bytes</span> <span class="o">=</span> <span class="n">mnemo</span><span class="p">.</span><span class="nf">to_entropy</span><span class="p">(</span><span class="n">words</span><span class="p">)</span>
<span class="n">out_int</span> <span class="o">=</span> <span class="nb">int</span><span class="p">.</span><span class="nf">from_bytes</span><span class="p">(</span><span class="n">out_bytes</span><span class="p">,</span> <span class="s">'little'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="nf">hex</span><span class="p">(</span><span class="n">out_int</span><span class="p">))</span>

<span class="c1"># 0x2af0f3958e106d1621658dbd7bd7653b
</span></code></pre></div></div> <p>В следующий раз мы обсудим более изощрённые <a href="/password_2/">методы кодирования</a> паролей, допускающих открытое хранение.</p> </div> </article> </main> <nav class="post-nav"> <a class="post-nav-item post-nav-next" href="/password_2/"> <div class="nav-arrow">Next</div> <span class="post-title">Эзотерическое кодирование</span> </a> </nav> <footer class="footer"> <a class="footer_item" href="https://t.me/d3ranged_blog">telegram</a> <a class="footer_item" href="/feed.xml">rss</a> <a class="footer_item" href="https://github.com/d3ranged">github</a> <small class="footer_copyright"> все права нарушены </small> </footer> <script src="/assets/js/main.js" defer="defer"></script> </div> </body> </html>
